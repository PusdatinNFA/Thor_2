title: Potential SocGholish Activity
id: ce4a8d0c-6784-45a7-99ba-7c8b8ec63be9
status: experimental
description: Detects specific process characteristics of SocGholish malware
references:
    - https://www.cybereason.com/blog/threat-analysis-report-socgholish-and-zloader-from-fake-updates-and-installers-to-owning-your-systems
    - https://redcanary.com/threat-detection-report/threats/socgholish/
author: Nasreddine Bencherchali (Nextron Systems)
date: 2023/02/27
tags:
    - attack.execution
    - attack.t1204
logsource:
    category: process_creation
    product: windows
detection:
    selection_generic:
        GrandParentImage|endswith:
            - '\winrar.exe'
            - '\7zFM.exe'
            - '\winzip.exe'
            - '\winzip64.exe'
            - '\peazip.exe'
        ParentImage|endswith: '\wscript.exe'
        Image|endswith:
            - '\nltest.exe'
            - '\whoami.exe'
            - '\systeminfo.exe'
    selection_tree_zip:
        ProcessTree|contains:
            - '\winrar.exe|'
            - '\7zFM.exe|'
            - '\winzip.exe|'
            - '\winzip64.exe|'
            - '\peazip.exe|'
    selection_tree_options:
        - ProcessTree|contains|all:
            - '\wscript.exe|'
            - '\cmd.exe|'
            - '\rundll32.exe|'
        - ProcessTree|contains|all:
            - '\wscript.exe|'
            - '\cmd.exe|'
            - '\regsvr32.exe|'
    selection_tree_options_children:
        ProcessTree|contains:
            - '\outlook.exe|'
            - '\svchost.exe|'
            - '\taskhost.exe|'
    condition: selection_generic or all of selection_tree_*
falsepositives:
    - Unlikely
level: high
