
# VALHALLA SIGMA RULE SET - DEMO
# Retrieved: 2024-03-07 01:36
# Generated for User: demo
# Number of Rules: 3139
# Warning:
#     The full rule set contains rules with low level (< high) 
#     that can lead to false positives - use the Python
#     module valhallaAPI tools to retrieve a filtered set
# This is the VALHALLA demo rule set. The content represents the 'SigmaHQ' repository
# in a streamlined format.
# All rules are licensed under DRL 1.1 https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md.
title: Potential Pikabot Discovery Activity
id: 698d4431-514f-4c82-af4d-cf573872a9f5
status: experimental
description: |
    Detects system discovery activity carried out by Pikabot, such as incl. network, user info and domain groups.
    The malware Pikabot has been seen to use this technique as part of its C2-botnet registration with a short collection time frame (less than 1 minute).
author: Andreas Braathen (mnemonic.io)
license: 'DRL 1.1 https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md'
date: 2023/10/27 15:51:51
references:
  - https://www.virustotal.com/gui/file/72f1a5476a845ea02344c9b7edecfe399f64b52409229edaf856fcb9535e3242
  - https://tria.ge/231023-lpw85she57/behavioral2
logsource:
    category: process_creation
    product: windows
    definition: 'Requirements: By default the process_creation type event might not
        contain the GrandParentImage. Make sure you collect such fields in order to
        use this rule'
detection:
    condition: all of selection_*
    selection_child:
        CommandLine:
          - ipconfig.exe /all
          - netstat.exe -aon
          - whoami.exe /all
    selection_parent:
      - GrandParentImage|endswith: \rundll32.exe
      - ParentImage|endswith:
          - \SearchFilterHost.exe
          - \SearchProtocolHost.exe
falsepositives: Unlikely
level: high
customer: 'demo'
modified: 2024/01/26
tags:
  - attack.discovery
  - attack.t1016
  - attack.t1049
  - attack.t1087
  - detection.emerging_threats
  - DEMO
