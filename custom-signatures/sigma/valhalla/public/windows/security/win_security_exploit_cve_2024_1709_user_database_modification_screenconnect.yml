
# VALHALLA SIGMA RULE SET - DEMO
# Retrieved: 2024-03-26 18:48
# Generated for User: demo
# Number of Rules: 3189
# Warning:
#     The full rule set contains rules with low level (< high) 
#     that can lead to false positives - use the Python
#     module valhallaAPI tools to retrieve a filtered set
# This is the VALHALLA demo rule set. The content represents the 'SigmaHQ' repository
# in a streamlined format.
# All rules are licensed under DRL 1.1 https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md.
title: ScreenConnect User Database Modification - Security
id: 4109cb6a-a4af-438a-9f0c-056abba41c6f
related:
  - type: similar
    id: 1a821580-588b-4323-9422-660f7e131020
status: experimental
description: |
    This detects file modifications to the temporary xml user database file indicating local user modification in the ScreenConnect server.
    This will occur during exploitation of the ScreenConnect Authentication Bypass vulnerability (CVE-2024-1709) in versions <23.9.8, but may also be observed when making legitimate modifications to local users or permissions.
    This requires an Advanced Auditing policy to log a successful Windows Event ID 4663 events and with a SACL set on the directory.
author: Matt Anderson, Kris Luzadre, Andrew Schwartz, Huntress
license: 'DRL 1.1 https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md'
date: 2024/02/20 19:24:11
references:
  - https://www.connectwise.com/company/trust/security-bulletins/connectwise-screenconnect-23.9.8
  - https://www.cve.org/CVERecord?id=CVE-2024-1709
  - https://www.huntress.com/blog/a-catastrophe-for-control-understanding-the-screenconnect-authentication-bypass
logsource:
    product: windows
    service: security
    definition: 'Requirements: SACLs must be enabled for the ScreenConnect directory'
detection:
    condition: selection
    selection:
        AccessMask: "0x6"
        EventID: "4663"
        ObjectName|contains|all:
          - Temp
          - ScreenConnect
        ObjectName|endswith: .xml
        ObjectType: File
        ProcessName|contains: ScreenConnect.Service.exe
falsepositives: This will occur legitimately as well and will result in some benign
    activity.
level: medium
customer: 'demo'
tags:
  - attack.defense_evasion
  - cve.2024.1709
  - DEMO
