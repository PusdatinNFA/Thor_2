
# VALHALLA SIGMA RULE SET - DEMO
# Retrieved: 2024-03-26 18:48
# Generated for User: demo
# Number of Rules: 3189
# Warning:
#     The full rule set contains rules with low level (< high) 
#     that can lead to false positives - use the Python
#     module valhallaAPI tools to retrieve a filtered set
# This is the VALHALLA demo rule set. The content represents the 'SigmaHQ' repository
# in a streamlined format.
# All rules are licensed under DRL 1.1 https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md.
title: Potential Pikabot C2 Activity
id: cae6cee6-0244-44d2-84ed-e65f548eb7dc
status: experimental
description: |
    Detects the execution of rundll32 that leads to an external network connection.
    The malware Pikabot has been seen to use this technique to initiate C2-communication through hard-coded Windows binaries.
author: Andreas Braathen (mnemonic.io)
license: 'DRL 1.1 https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md'
date: 2023/10/27 13:32:41
references:
  - https://www.virustotal.com/gui/file/d72af640b71b8e3eca3eba660dd7c7f029ff8852bcacaa379e7b6c57cf4d9b44
  - https://www.virustotal.com/gui/file/6bb4cdbaef03b732a93559a58173e7f16b29bfb159a1065fae9185000ff23b4b
  - https://github.com/pr0xylife/Pikabot/blob/7f7723a74ca325ec54c6e61e076acce9a4b20538/Pikabot_06.12.2023.txt
logsource:
    category: network_connection
    product: windows
    definition: 'Requirements: By default the network_connection type event might
        not contain the ParentImage. Make sure you collect such fields in order to
        use this rule'
detection:
    condition: selection
    selection:
        Image|endswith:
          - \SearchFilterHost.exe
          - \SearchProtocolHost.exe
          - \sndvol.exe
          - \wermgr.exe
          - \wwahost.exe
        Initiated: "true"
        ParentImage|endswith: \rundll32.exe
        Protocol: tcp
falsepositives: Unlikely
level: high
customer: 'demo'
modified: 2024/01/26
tags:
  - attack.command_and_control
  - attack.t1573
  - detection.emerging_threats
  - DEMO
