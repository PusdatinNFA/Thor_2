
# VALHALLA SIGMA RULE SET - DEMO
# Retrieved: 2024-03-26 18:48
# Generated for User: demo
# Number of Rules: 3189
# Warning:
#     The full rule set contains rules with low level (< high) 
#     that can lead to false positives - use the Python
#     module valhallaAPI tools to retrieve a filtered set
# This is the VALHALLA demo rule set. The content represents the 'SigmaHQ' repository
# in a streamlined format.
# All rules are licensed under DRL 1.1 https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md.
title: Potential XCSSET Malware Infection
id: 47d65ac0-c06f-4ba2-a2e3-d263139d0f51
status: test
description: Identifies the execution traces of the XCSSET malware. XCSSET is a macOS
    trojan that primarily spreads via Xcode projects and maliciously modifies applications.
    Infected users are also vulnerable to having their credentials, accounts, and
    other vital data stolen.
author: Tim Rauch (rule), Elastic (idea)
license: 'DRL 1.1 https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md'
date: 2022/10/17 14:45:41
references:
  - https://github.com/elastic/protections-artifacts/commit/746086721fd385d9f5c6647cada1788db4aea95f#diff-f5deb07688e1a8dec9530bc3071967b2da5c16b482e671812b864c37beb28f08
  - https://malpedia.caad.fkie.fraunhofer.de/details/osx.xcsset
logsource:
    category: process_creation
    product: macos
detection:
    condition: all of selection_1_* or 1 of selection_other_*
    selection_1_curl:
        CommandLine|contains:
          - /sys/log.php
          - /sys/prepod.php
          - /sys/bin/Pods
        Image|endswith: /curl
        ParentImage|endswith: /bash
    selection_1_https:
        CommandLine|contains: https://
    selection_other_1:
        CommandLine|contains|all:
          - /Users/
          - /Library/Group Containers/
        Image|endswith: /osacompile
        ParentImage|endswith: /bash
    selection_other_2:
        CommandLine|contains|all:
          - LSUIElement
          - /Users/
          - /Library/Group Containers/
        Image|endswith: /plutil
        ParentImage|endswith: /bash
    selection_other_3:
        CommandLine|contains|all:
          - -r
          - /Users/
          - /Library/Group Containers/
        Image|endswith: /zip
falsepositives: Unknown
level: medium
customer: 'demo'
tags:
  - attack.command_and_control
  - DEMO
