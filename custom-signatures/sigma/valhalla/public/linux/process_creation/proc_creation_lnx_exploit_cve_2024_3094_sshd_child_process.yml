
# VALHALLA SIGMA RULE SET - DEMO
# Retrieved: 2024-06-21 19:00
# Generated for User: demo
# Number of Rules: 3228
# Warning:
#     The full rule set contains rules with low level (< high) 
#     that can lead to false positives - use the Python
#     module valhallaAPI tools to retrieve a filtered set
# This is the VALHALLA demo rule set. The content represents the 'SigmaHQ' repository
# in a streamlined format.
# All rules are licensed under DRL 1.1 https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md.
title: Potential Exploitation of CVE-2024-3094 - Suspicious SSH Child Process
id: 9aa27839-e8ba-4d7a-ac1a-746c22c3d1e5
status: experimental
description: |
    Detects potentially suspicious child process of SSH process (sshd) with a specific execution user. This could be a sign of potential exploitation of CVE-2024-3094.
author: Arnim Rupp, Nasreddine Bencherchali, Thomas Patzke
license: 'DRL 1.1 https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md'
date: 2024/04/01 22:39:01
references:
  - https://github.com/amlweems/xzbot?tab=readme-ov-file#backdoor-demo
logsource:
    category: process_creation
    product: linux
detection:
    condition: 1 of selection_*
    selection_1:
        CommandLine|startswith:
          - bash -c
          - sh -c
        ParentImage|endswith: /sshd
        User: root
    selection_2:
        CommandLine|contains: root
        Image|endswith: /sshd
        ParentImage|endswith: /sshd
        User: sshd
falsepositives: Administrative activity directly with root authentication might trigger
    selection_1 if it's unnecessarily prefixed with "sh -c" or "bash -c"
level: high
customer: 'demo'
modified: 2024/04/12
tags:
  - attack.execution
  - cve.2024.3094
  - DEMO
