
# VALHALLA SIGMA RULE SET - DEMO
# Retrieved: 2024-06-21 19:00
# Generated for User: demo
# Number of Rules: 3228
# Warning:
#     The full rule set contains rules with low level (< high) 
#     that can lead to false positives - use the Python
#     module valhallaAPI tools to retrieve a filtered set
# This is the VALHALLA demo rule set. The content represents the 'SigmaHQ' repository
# in a streamlined format.
# All rules are licensed under DRL 1.1 https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md.
title: Potential CVE-2024-3400 Exploitation - Palo Alto GlobalProtect OS Command Injection
id: f130a5f1-73ba-42f0-bf1e-b66a8361cb8f
status: experimental
description: |
    Detects potential exploitation attempts of CVE-2024-3400 - an OS command injection in Palo Alto GlobalProtect.
    This detection looks for suspicious strings that indicate a potential directory traversal attempt or command injection.
author: Nasreddine Bencherchali (Nextron Systems)
license: 'DRL 1.1 https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md'
date: 2024/04/18 01:58:21
references:
  - https://security.paloaltonetworks.com/CVE-2024-3400
  - https://labs.watchtowr.com/palo-alto-putting-the-protecc-in-globalprotect-cve-2024-3400/
  - https://attackerkb.com/topics/SSTk336Tmf/cve-2024-3400/rapid7-analysis
logsource:
    category: appliance
    product: paloalto
    service: globalprotect
    definition: 'Requirements: Palo Alto GlobalProtect "mp-log" and "gpsvc.log" log
        files need to be ingested'
detection:
    condition: keywords_generic or all of keywords_telemetry_*
    keywords_generic:
      - failed to unmarshal session(../
      - failed to unmarshal session(./../
      - failed to unmarshal session(/..
      - failed to unmarshal session(%2E%2E%2F
      - failed to unmarshal session(%2F%2E%2E
      - failed to unmarshal session(%2E%2F%2E%2E%2F
      - failed to unmarshal session(%252E%252E%252F
      - failed to unmarshal session(%252F%252E%252E
      - failed to unmarshal session(%252E%252F%252E%252E%252F
    keywords_telemetry_exploit:
      - '{IFS}'
      - base64
      - bash
      - curl
      - http
    keywords_telemetry_path: /opt/panlogs/tmp/device_telemetry/
falsepositives: Unknown
level: high
customer: 'demo'
modified: 2024/04/25
tags:
  - attack.initial_access
  - attack.persistence
  - attack.privilege_escalation
  - attack.defense_evasion
  - cve.2024.3400
  - DEMO
