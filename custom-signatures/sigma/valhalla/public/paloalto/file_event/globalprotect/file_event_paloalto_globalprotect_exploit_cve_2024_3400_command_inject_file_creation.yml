
# VALHALLA SIGMA RULE SET - DEMO
# Retrieved: 2024-06-21 19:00
# Generated for User: demo
# Number of Rules: 3228
# Warning:
#     The full rule set contains rules with low level (< high) 
#     that can lead to false positives - use the Python
#     module valhallaAPI tools to retrieve a filtered set
# This is the VALHALLA demo rule set. The content represents the 'SigmaHQ' repository
# in a streamlined format.
# All rules are licensed under DRL 1.1 https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md.
title: Potential CVE-2024-3400 Exploitation - Palo Alto GlobalProtect OS Command Injection
    - File Creation
id: bcd95697-e3e7-4c6f-8584-8e3503e6929f
status: experimental
description: |
    Detects suspicious file creations in the Palo Alto Networks PAN-OS' parent telemetry folder, which are processed by the vulnerable 'dt_curl' script if device telemetry is enabled.
    As said script overrides the shell-subprocess restriction, arbitrary command execution may occur by carefully crafting filenames that are escaped through this function.
author: Andreas Braathen (mnemonic.io)
license: 'DRL 1.1 https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md'
date: 2024/04/25 05:42:41
references:
  - https://labs.watchtowr.com/palo-alto-putting-the-protecc-in-globalprotect-cve-2024-3400/
  - https://nvd.nist.gov/vuln/detail/CVE-2024-3400
logsource:
    category: file_event
    product: paloalto
    service: globalprotect
    definition: 'Requirements: file creation events need to be ingested from the Palo
        Alto GlobalProtect appliance'
detection:
    condition: selection
    selection:
        TargetFilename|contains:
          - '{IFS}'
          - base64
          - bash
          - curl
          - http
        TargetFilename|startswith: /opt/panlogs/tmp/device_telemetry/
falsepositives: The PAN-OS device telemetry function does not enforce a standard filename
    convention, but observations are unlikely.
level: medium
customer: 'demo'
tags:
  - attack.execution
  - cve.2024.3400
  - detection.emerging_threats
  - DEMO
