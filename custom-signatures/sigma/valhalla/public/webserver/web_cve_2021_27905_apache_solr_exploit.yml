
# VALHALLA SIGMA RULE SET - DEMO
# Retrieved: 2024-03-26 18:48
# Generated for User: demo
# Number of Rules: 3189
# Warning:
#     The full rule set contains rules with low level (< high) 
#     that can lead to false positives - use the Python
#     module valhallaAPI tools to retrieve a filtered set
# This is the VALHALLA demo rule set. The content represents the 'SigmaHQ' repository
# in a streamlined format.
# All rules are licensed under DRL 1.1 https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md.
title: Potential CVE-2021-27905 Exploitation Attempt
id: 0bbcd74b-0596-41a4-94a0-4e88a76ffdb3
status: test
description: Detects exploitation attempt of the CVE-2021-27905 which affects all
    Apache Solr versions prior to and including 8.8.1.
author: '@gott_cyber'
license: 'DRL 1.1 https://github.com/SigmaHQ/sigma/blob/master/LICENSE.Detection.Rules.md'
date: 2022/12/11 16:37:51
references:
  - https://twitter.com/Al1ex4/status/1382981479727128580
  - https://twitter.com/sec715/status/1373472323538362371
  - https://nsfocusglobal.com/apache-solr-arbitrary-file-read-and-ssrf-vulnerability-threat-alert/
  - https://mp.weixin.qq.com/s?__biz=Mzg3NDU2MTg0Ng==&mid=2247484117&idx=1&sn=2fdab8cbe4b873f8dd8abb35d935d186
  - https://github.com/murataydemir/CVE-2021-27905
logsource:
    category: webserver
detection:
    condition: 1 of selection_*
    selection_request1:
        cs-uri-query|contains|all:
          - /solr/
          - /debug/dump?
          - param=ContentStream
        sc-status: "200"
    selection_request2:
        cs-method: GET
        cs-uri-query|contains|all:
          - /solr/
          - command=fetchindex
          - masterUrl=
        sc-status: "200"
falsepositives: Vulnerability Scanners
level: medium
customer: 'demo'
modified: 2023/03/24
tags:
  - attack.initial_access
  - attack.t1190
  - cve.2021.27905
  - detection.emerging_threats
  - DEMO
